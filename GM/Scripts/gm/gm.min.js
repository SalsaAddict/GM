var GM,gm;(function(n){"use strict";var t,i,r;n.googleApiKey="AIzaSyCtuJp3jsaJp3X6U8ZS_X5H8omiAw5QaHg";n.debugEnabled=!0;n.authenticated=!1,function(n){var t=function(){function n(n,t,i){this.$q=n;this.$http=t;this.$log=i}return n.prototype.execute=function(n,t){t===void 0&&(t={});var r={name:n,parameters:t},i=this.$q.defer();return this.$http.post("execute.ashx",r).then(function(n){i.resolve(n.data)},function(n){i.resolve({success:!1,data:n.statusText})}),i.promise},n.$inject=["$q","$http","$log"],n}();n.Service=t}(t=n.Database||(n.Database={})),function(t){function i(n){for(var i,r=["youtube.com/.*?v=([^?&/]+)","youtu.be/([^?&/]+)"],u,t=0;t<r.length;t++)if(i=new RegExp(r[t],"i"),i.test(n)){u=i.exec(n)[1];break}return u}function r(){var t=function(t,r){return{restrict:"A",scope:{video:"=videoIdValidator"},require:["ngModel"],link:function(u,f,e,o){o[0].$parsers.unshift(function(n){return o[0].$isEmpty(n)&&delete u.video,n});o[0].$asyncValidators.videoId=function(f,e){var h=i(f||e),o=r.defer(),c=function(n){u.video=n;o.resolve(!0)},s=function(){delete u.video;o.reject(!1)};return h?(t.get("https://www.googleapis.com/youtube/v3/videos?id="+h+"&key="+n.googleApiKey+"&part=snippet").then(function(n){try{var t=n.data.items[0];if(t.id!==h){s();return}c({id:t.id,title:t.snippet.title,thumbnail:t.snippet.thumbnails.medium.url})}catch(i){s()}},function(){s()}),o.promise):(s(),o.promise)}}}};return t.$inject=["$http","$q"],t}t.VideoIdFromUrl=i;t.DirectiveFactory=r}(i=n.VideoIdValidator||(n.VideoIdValidator={})),function(n){var t=function(){function n(n,t,i){this.$scope=n;this.$database=t;this.$http=i;this.FetchGenres()}return n.prototype.FetchGenres=function(){var n=this;this.$database.execute("apiGenres").then(function(t){n.Genres=t.data.Genres})},n.prototype.FetchStyles=function(){var n=this;this.$database.execute("apiStyles",{GenreId:{value:this.GenreId}}).then(function(t){n.Styles=t.data.Styles})},Object.defineProperty(n.prototype,"SelectedStyles",{get:function(){var t,n;if(angular.isArray(this.Styles)){for(n=0;n<this.Styles.length;n++)if(this.Styles[n].Checked){t=!0;break}return t}},enumerable:!0,configurable:!0}),n.prototype.Submit=function(){this.$database.execute("apiRecommend",{VideoId:{value:this.$scope.video.id},Title:{value:this.$scope.video.title},Thumbnail:{value:this.$scope.video.thumbnail},Styles:{value:this.Styles,isObject:!0}}).then(function(n){console.log("submitted",n)})},n.$inject=["$scope","$database","$http"],n}();n.Controller=t}(r=n.Recommend||(n.Recommend={}))})(GM||(GM={}));gm=angular.module("gm",["ngRoute","ngAnimate","ngAria","ngMessages","ngSanitize","ngMaterial"]);gm.service("$database",GM.Database.Service);gm.directive("videoIdValidator",GM.VideoIdValidator.DirectiveFactory());gm.config(["$mdThemingProvider","$routeProvider","$logProvider",function(n,t,i){n.theme("default").primaryPalette("blue").accentPalette("indigo").warnPalette("red").backgroundPalette("grey");t.caseInsensitiveMatch=!0;t.when("/home",{templateUrl:"Views/home.html"}).when("/recommend",{templateUrl:"Views/recommend.html",controller:GM.Recommend.Controller,controllerAs:"ctrl"}).otherwise({redirectTo:"/home"});i.debugEnabled(GM.debugEnabled)}]);gm.run(["$log",function(){GM.authenticated=document.getElementById("gm-script").getAttribute("data-authenticated").toLowerCase()==="true"}]);